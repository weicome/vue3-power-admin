import{e as y,a as oe}from"./index-5c206c91.js";import{c as N,e as ne,_ as se}from"./leader-8c43c354.js";/* empty css                 */import{l as M,a as ue}from"./usePage-67b3c0cf.js";import{r as F,d as j,b as m,D as d,E as P,V as s,u as a,f as U,F as h,Y as n,a0 as v,Z as g,W as S,ah as B,a2 as z}from"./vue-bfef4675.js";import{B as re,K as ie,L as de,z as pe,y as ce,M as fe,C as me,J as be}from"./element-plus-26e85d15.js";import"./vue-i18n-81613396.js";import"./pinia-574b3635.js";import"./vue-router-20616233.js";import"./nprogress-c3ec224b.js";import"./mockjs-de833af9.js";import"./axios-dc3e32a0.js";/* empty css            */const _e=o=>y.POST({url:"/phone/index",useMock:!1,data:o}),ve=o=>y.POST({url:"/phone/create",useMock:!1,data:o}),ge=o=>y.POST({url:"/phone/export",useMock:!1,data:o}),he=()=>y.POST({url:"/phone/clear",useMock:!1}),ye=o=>y.POST({url:"/phone/delete",useMock:!1,data:o}),ke=o=>y.POST({url:"/phone/upload",useMock:!1,headers:{"Content-Type":"multipart/form-data"},data:o}),we=()=>y.POST({url:"/phone/batch",useMock:!1}),{ElInput:Ve,ElSelect:I}=ne(),q=F([{label:"请选择批次",value:""}]);we().then(o=>{o==null||o.forEach(r=>q.push({label:"第".concat(r.batch,"批次"),value:r.batch}))});var k=(o=>(o.ADD="新增数据",o.EXPORT="导出并清除数据",o.BATCHDEL="按批次删除",o))(k||{});const x=[{label:"等待处理",value:0},{label:"已接通",value:1},{label:"已同意",value:2},{label:"未接通(通话中/语音助手/在忙稍后回电)",value:3},{label:"拒绝",value:4},{label:"直接挂断",value:5},{label:"关机/停机/空号",value:-1}],Ce=[{component:I,label:"数据归属",field:"leader_id",clearable:!0,options:M},{component:I,label:"数据状态",field:"status",clearable:!0,options:x},{component:Ve,label:"号码",field:"phone",placeholder:"请输入"}],Pe=[{fixed:!0,prop:"id",label:"编号",width:"70",align:"center"},{prop:"phone",label:"手机号"},{prop:"leader_id",label:"归属组长",slot:({row:o})=>{var r;return(r=M)==null?void 0:r.map(D=>D.value===o.leader_id&&N(D.label||""))}},{prop:"status",label:"数据步骤",slot:({row:o})=>x==null?void 0:x.map(r=>r.value===o.status&&N(r.label||""))},{prop:"batch",label:"批次"},{prop:"created_at",label:"添加时间"}],xe={"page-card":""},De={flex:"",items:"center"},Te=h("div",{"i-ri-add-fill":"","mr-1":""},null,-1),Ee=h("div",{"i-ri-exchange-box-fill":"","mr-1":""},null,-1),Re=h("div",{"i-ri-format-clear":"","mr-1":""},null,-1),Se=h("div",{"i-ri-delete-bin-line":"","mr-1":""},null,-1),Be=h("div",{"i-ri-upload-cloud-fill":"","mr-1":""},null,-1),Fe={class:"dialog-footer"},Me=j({name:"Phone"}),Ke=j({...Me,setup(o){const{$message:r,$msgbox:D}=oe(),H=m(),b=m(!1),i=m({label:k.ADD,val:0}),w=m(),V=F({phone:""}),O=m(!1),A=m([]),c=F({page:1,size:10,total:0}),u=F({leader_id:0,file:""}),_=()=>{O.value=!0,setTimeout(async()=>{const{data:t,meta:e}=await _e({query:V,...c});c.page=e.pagination.current_page,c.size=e.pagination.per_page,c.total=e.pagination.count,O.value=!1,A.value=t},300)},X=()=>{Object.assign(V,{}),_()};function J(t){W.value=t}function K(t){c.page=t,_()}function Q(t){c.size=t,_()}const W=m([]),T=async t=>{Object.assign(u,{}),b.value=!0,t===0?i.value={label:k.ADD,val:t}:t===1?i.value={label:k.EXPORT,val:t}:t===2?(b.value=!1,i.value={label:k.ADD,val:t},D.confirm("确定要清除所有的数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{he().then(()=>{r.success("删除成功！"),_()}).catch(e=>{r.warning(e)})})):t===3&&(i.value={label:k.BATCHDEL,val:t})};async function Y(){var e;let t=null;i.value.val!==2&&((e=w.value)==null||e.validate(async f=>{f?(i.value.val===0?t=await ve(u):i.value.val===1?t=await ge(u):i.value.val===3&&(t=await ye(u)),t!==void 0||t!==null?(b.value=!1,r.success("操作成功！"),_()):r.warning("出现错误，请重试")):r.warning("请完善必填选项！")}))}const Z=m(),L=new FormData,G=()=>{u.files!==""&&ke(L).then(t=>{u.file=t[0],r.success("上传成功")}).catch(t=>{r.warning(t)})},ee=(t,e)=>{L.append("file",t.raw)};return _(),(t,e)=>{const f=re,E=ie,R=de,C=pe,le=ce,ae=fe,$=me,te=be;return d(),P("div",xe,[s(a(ue),{modelValue:a(V),"onUpdate:modelValue":e[0]||(e[0]=l=>U(V)?V.value=l:null),config:a(Ce),"per-line-count":4,onQuery:_,onReset:X},null,8,["modelValue","config"]),h("div",De,[s(f,{type:"success",onClick:e[1]||(e[1]=l=>T(0))},{default:n(()=>[Te,v(" 新增 ")]),_:1}),s(f,{type:"primary",onClick:e[2]||(e[2]=l=>T(1))},{default:n(()=>[Ee,v(" 导出并清除所有数据 ")]),_:1}),s(f,{type:"danger",onClick:e[3]||(e[3]=l=>T(2))},{default:n(()=>[Re,v(" 清除所有数据 ")]),_:1}),s(f,{type:"danger",onClick:e[4]||(e[4]=l=>T(3))},{default:n(()=>[Se,v(" 批次删除 ")]),_:1})]),s(a(se),{ref_key:"tableModelRef",ref:H,pagination:a(c),"onUpdate:pagination":e[5]||(e[5]=l=>U(c)?c.value=l:null),loading:a(O),columns:a(Pe),data:a(A),"row-key":"id",onSelectionChange:J,onPageChange:K,onSizeChange:Q},null,8,["pagination","loading","columns","data"]),s(te,{modelValue:a(b),"onUpdate:modelValue":e[12]||(e[12]=l=>U(b)?b.value=l:null),width:560,title:a(i).label,"show-close":!1,"close-on-click-modal":!1,onClosed:e[13]||(e[13]=l=>{var p;return(p=a(w))==null?void 0:p.resetFields()})},{footer:n(()=>[h("span",Fe,[s(f,{onClick:e[11]||(e[11]=l=>b.value=!1)},{default:n(()=>[v("取消")]),_:1}),s(f,{type:"primary",onClick:Y},{default:n(()=>[v(" 保存 ")]),_:1})])]),default:n(()=>[a(i).val===0?(d(),g($,{key:0,ref_key:"submitFormRef",ref:w,model:a(u),"label-width":"100px",style:{width:"95%"},"status-icon":""},{default:n(()=>[s(C,{label:"归属组长",prop:"leader_id"},{default:n(()=>[s(R,{modelValue:a(u).leader_id,"onUpdate:modelValue":e[6]||(e[6]=l=>a(u).leader_id=l),style:{width:"100%"}},{default:n(()=>[(d(!0),P(S,null,B(a(M),(l,p)=>(d(),g(E,{key:p,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(C,{label:"号码文件",prop:"file"},{default:n(()=>[s(ae,{ref_key:"uploadRef",ref:Z,"auto-upload":!1,limit:1,accept:".txt","with-credentials":!0,"on-change":ee},{trigger:n(()=>[s(le,{modelValue:a(u).file,"onUpdate:modelValue":e[7]||(e[7]=l=>a(u).file=l),placeholder:"请选择文件"},null,8,["modelValue"])]),default:n(()=>[s(f,{class:"ml-3",type:"success",onClick:G},{default:n(()=>[Be,v(" 上传 ")]),_:1})]),_:1},512)]),_:1})]),_:1},8,["model"])):z("",!0),a(i).val===1?(d(),g($,{key:1,ref_key:"submitFormRef",ref:w,model:a(u),"label-width":"100px",style:{width:"95%"},"status-icon":""},{default:n(()=>[s(C,{label:"归属组长",prop:"leader_id"},{default:n(()=>[s(R,{modelValue:a(u).leader_id,"onUpdate:modelValue":e[8]||(e[8]=l=>a(u).leader_id=l),style:{width:"100%"}},{default:n(()=>[(d(!0),P(S,null,B(a(M),(l,p)=>(d(),g(E,{key:p,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(C,{label:"数据状态",prop:"status"},{default:n(()=>[s(R,{modelValue:a(u).status,"onUpdate:modelValue":e[9]||(e[9]=l=>a(u).status=l),style:{width:"100%"}},{default:n(()=>[(d(!0),P(S,null,B(a(x),(l,p)=>(d(),g(E,{key:p,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])):z("",!0),a(i).val===3?(d(),g($,{key:2,ref_key:"submitFormRef",ref:w,model:a(u),"label-width":"100px",style:{width:"95%"},"status-icon":""},{default:n(()=>[s(C,{label:"批次信息",prop:"leader_id"},{default:n(()=>[s(R,{modelValue:a(u).batch,"onUpdate:modelValue":e[10]||(e[10]=l=>a(u).batch=l),style:{width:"100%"}},{default:n(()=>[(d(!0),P(S,null,B(a(q),(l,p)=>(d(),g(E,{key:p,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])):z("",!0)]),_:1},8,["modelValue","title"])])}}});export{Ke as default};
