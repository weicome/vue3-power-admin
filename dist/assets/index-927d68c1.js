import{e as y,a as oe}from"./index-50631119.js";/* empty css               *//* empty css                  */import{_ as ne}from"./TableModel.vuevuetypescriptsetuptruenameTableModellang-eb1352c5.js";import{l as B}from"./usePage-9be628c1.js";import{u as I,a as se}from"./useColumn-3a58f8fd.js";import{r as R,d as H,b as m,D as d,E as x,V as s,u as a,f as M,F as h,Y as n,a0 as v,Z as g,W as E,ah as O,a2 as U}from"./vue-bfef4675.js";import{S as ue}from"./SearchModel-2c89adf6.js";import{B as ie,H as re,I as de,z as pe,y as fe,O as ce,C as me,L as be}from"./element-plus-3a9b3aba.js";import"./vue-i18n-81613396.js";import"./pinia-574b3635.js";import"./vue-router-20616233.js";import"./nprogress-c3ec224b.js";import"./mockjs-de833af9.js";import"./axios-dc3e32a0.js";/* empty css                 */import"./leader-638638be.js";/* empty css            */const _e=o=>y.POST({url:"/phone/index",useMock:!1,data:o}),ve=o=>y.POST({url:"/phone/create",useMock:!1,data:o}),ge=o=>y.POST({url:"/phone/export",useMock:!1,data:o}),he=()=>y.POST({url:"/phone/clear",useMock:!1}),ye=o=>y.POST({url:"/phone/delete",useMock:!1,data:o}),ke=o=>y.POST({url:"/phone/upload",useMock:!1,headers:{"Content-Type":"multipart/form-data"},data:o}),we=()=>y.POST({url:"/phone/batch",useMock:!1}),{ElInput:Ve,ElSelect:N}=se(),j=R([{label:"请选择批次",value:""}]);we().then(o=>{o==null||o.forEach(i=>j.push({label:"第".concat(i.batch,"批次"),value:i.batch}))});var k=(o=>(o.ADD="新增数据",o.EXPORT="导出并清除数据",o.BATCHDEL="按批次删除",o))(k||{});const z=[{label:"等待处理",value:0},{label:"已接通",value:1},{label:"已同意",value:2},{label:"未接通(通话中/语音助手/在忙稍后回电)",value:3},{label:"拒绝",value:4},{label:"直接挂断",value:5},{label:"关机/停机/空号",value:-1}],Ce=[{component:N,label:"数据归属",field:"leader_id",clearable:!0,options:B},{component:N,label:"数据状态",field:"status",clearable:!0,options:z},{component:Ve,label:"号码",field:"phone",placeholder:"请输入"}],Pe=[{fixed:!0,prop:"id",label:"编号",width:"70",align:"center"},{prop:"phone",label:"手机号"},{prop:"leader_id",label:"归属组长",slot:({row:o})=>{var i;return[I(((i=B.find(w=>w.value===o.leader_id))==null?void 0:i.label)||"")]}},{prop:"status",label:"数据步骤",slot:({row:o})=>{var i;return[I(((i=z.find(w=>w.value===o.status))==null?void 0:i.label)||"")]}},{prop:"batch",label:"批次"},{prop:"created_at",label:"添加时间"}],xe={"page-card":""},De={flex:"",items:"center"},Se=h("div",{"i-ri-add-fill":"","mr-1":""},null,-1),Te=h("div",{"i-ri-exchange-box-fill":"","mr-1":""},null,-1),Ee=h("div",{"i-ri-format-clear":"","mr-1":""},null,-1),Oe=h("div",{"i-ri-delete-bin-line":"","mr-1":""},null,-1),Re=h("div",{"i-ri-upload-cloud-fill":"","mr-1":""},null,-1),Be={class:"dialog-footer"},Fe=H({name:"Phone"}),Ke=H({...Fe,setup(o){const{$message:i,$msgbox:w}=oe(),q=m(),b=m(!1),r=m({label:k.ADD,val:0}),V=m(),C=R({phone:""}),F=m(!1),A=m([]),f=R({page:1,size:10,total:0}),u=R({leader_id:0,file:""}),_=()=>{F.value=!0,setTimeout(async()=>{const{data:t,meta:e}=await _e({query:C,...f});f.page=e.pagination.current_page,f.size=e.pagination.per_page,f.total=e.pagination.count,F.value=!1,A.value=t},300)},X=()=>{Object.assign(C,{}),_()};function Q(t){Z.value=t}function W(t){f.page=t,_()}function Y(t){f.size=t,_()}const Z=m([]),D=async t=>{Object.assign(u,{}),b.value=!0,t===0?r.value={label:k.ADD,val:t}:t===1?r.value={label:k.EXPORT,val:t}:t===2?(b.value=!1,r.value={label:k.ADD,val:t},w.confirm("确定要清除所有的数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{he().then(()=>{i.success("删除成功！"),_()}).catch(e=>{i.warning(e)})})):t===3&&(r.value={label:k.BATCHDEL,val:t})};async function G(){var e;let t=null;r.value.val!==2&&((e=V.value)==null||e.validate(async c=>{c?(r.value.val===0?t=await ve(u):r.value.val===1?t=await ge(u):r.value.val===3&&(t=await ye(u)),t!==void 0||t!==null?(b.value=!1,i.success("操作成功！"),_()):i.warning("出现错误，请重试")):i.warning("请完善必填选项！")}))}const J=m(),L=new FormData,K=()=>{u.files!==""&&ke(L).then(t=>{u.file=t[0],i.success("上传成功")}).catch(t=>{i.warning(t)})},ee=(t,e)=>{L.append("file",t.raw)};return _(),(t,e)=>{const c=ie,S=re,T=de,P=pe,le=fe,ae=ce,$=me,te=be;return d(),x("div",xe,[s(a(ue),{modelValue:a(C),"onUpdate:modelValue":e[0]||(e[0]=l=>M(C)?C.value=l:null),config:a(Ce),"per-line-count":4,onQuery:_,onReset:X},null,8,["modelValue","config"]),h("div",De,[s(c,{type:"success",onClick:e[1]||(e[1]=l=>D(0))},{default:n(()=>[Se,v(" 新增 ")]),_:1}),s(c,{type:"primary",onClick:e[2]||(e[2]=l=>D(1))},{default:n(()=>[Te,v(" 导出并清除所有数据 ")]),_:1}),s(c,{type:"danger",onClick:e[3]||(e[3]=l=>D(2))},{default:n(()=>[Ee,v(" 清除所有数据 ")]),_:1}),s(c,{type:"danger",onClick:e[4]||(e[4]=l=>D(3))},{default:n(()=>[Oe,v(" 批次删除 ")]),_:1})]),s(a(ne),{ref_key:"tableModelRef",ref:q,pagination:a(f),"onUpdate:pagination":e[5]||(e[5]=l=>M(f)?f.value=l:null),loading:a(F),columns:a(Pe),data:a(A),"row-key":"id",onSelectionChange:Q,onPageChange:W,onSizeChange:Y},null,8,["pagination","loading","columns","data"]),s(te,{modelValue:a(b),"onUpdate:modelValue":e[12]||(e[12]=l=>M(b)?b.value=l:null),width:560,title:a(r).label,"show-close":!1,"close-on-click-modal":!1,onClosed:e[13]||(e[13]=l=>{var p;return(p=a(V))==null?void 0:p.resetFields()})},{footer:n(()=>[h("span",Be,[s(c,{onClick:e[11]||(e[11]=l=>b.value=!1)},{default:n(()=>[v("取消")]),_:1}),s(c,{type:"primary",onClick:G},{default:n(()=>[v(" 保存 ")]),_:1})])]),default:n(()=>[a(r).val===0?(d(),g($,{key:0,ref_key:"submitFormRef",ref:V,model:a(u),"label-width":"100px",style:{width:"95%"},"status-icon":""},{default:n(()=>[s(P,{label:"归属组长",prop:"leader_id"},{default:n(()=>[s(T,{modelValue:a(u).leader_id,"onUpdate:modelValue":e[6]||(e[6]=l=>a(u).leader_id=l),style:{width:"100%"}},{default:n(()=>[(d(!0),x(E,null,O(a(B),(l,p)=>(d(),g(S,{key:p,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(P,{label:"号码文件",prop:"file"},{default:n(()=>[s(ae,{ref_key:"uploadRef",ref:J,"auto-upload":!1,limit:1,accept:".txt","with-credentials":!0,"on-change":ee},{trigger:n(()=>[s(le,{modelValue:a(u).file,"onUpdate:modelValue":e[7]||(e[7]=l=>a(u).file=l),placeholder:"请选择文件"},null,8,["modelValue"])]),default:n(()=>[s(c,{class:"ml-3",type:"success",onClick:K},{default:n(()=>[Re,v(" 上传 ")]),_:1})]),_:1},512)]),_:1})]),_:1},8,["model"])):U("",!0),a(r).val===1?(d(),g($,{key:1,ref_key:"submitFormRef",ref:V,model:a(u),"label-width":"100px",style:{width:"95%"},"status-icon":""},{default:n(()=>[s(P,{label:"归属组长",prop:"leader_id"},{default:n(()=>[s(T,{modelValue:a(u).leader_id,"onUpdate:modelValue":e[8]||(e[8]=l=>a(u).leader_id=l),style:{width:"100%"}},{default:n(()=>[(d(!0),x(E,null,O(a(B),(l,p)=>(d(),g(S,{key:p,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(P,{label:"数据状态",prop:"status"},{default:n(()=>[s(T,{modelValue:a(u).status,"onUpdate:modelValue":e[9]||(e[9]=l=>a(u).status=l),style:{width:"100%"}},{default:n(()=>[(d(!0),x(E,null,O(a(z),(l,p)=>(d(),g(S,{key:p,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])):U("",!0),a(r).val===3?(d(),g($,{key:2,ref_key:"submitFormRef",ref:V,model:a(u),"label-width":"100px",style:{width:"95%"},"status-icon":""},{default:n(()=>[s(P,{label:"批次信息",prop:"leader_id"},{default:n(()=>[s(T,{modelValue:a(u).batch,"onUpdate:modelValue":e[10]||(e[10]=l=>a(u).batch=l),style:{width:"100%"}},{default:n(()=>[(d(!0),x(E,null,O(a(j),(l,p)=>(d(),g(S,{key:p,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])):U("",!0)]),_:1},8,["modelValue","title"])])}}});export{Ke as default};
